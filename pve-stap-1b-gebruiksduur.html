<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>POM – Gebruiksduur</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/styles.css"/>
</head>
<body class="min-h-screen bg-gray-50 p-8">

  <div class="mx-auto">
    <a href="project-overzicht.html" class="text-xs text-gray-400 hover:text-violet-600">← Project overzicht</a>
    <h1 id="project-titel" class="text-xl font-semibold text-gray-700 mt-1 mb-2"></h1>

    <div id="step-indicator" class="mb-6"></div>

    <div class="flex gap-6">
      <div id="nav-panel" class="nav-panel"></div>

      <div class="flex-1">
        <h2 class="text-2xl font-semibold text-gray-700 mb-4">Gebruiksduur instellen</h2>

        <div class="flex flex-col gap-4 max-w-2xl">
          <div class="card">
            <div class="grid grid-cols-2 gap-x-6 gap-y-4 text-sm max-w-lg">

              <label class="form-label self-center">Gebruiksduur in jaar</label>
              <div class="flex items-center gap-2">
                <input id="gebruiksduur" type="number" class="input-field w-28" min="1" max="100" value="40"/>
                <span class="info-wrap">
                  <button class="info-btn" type="button">i</button>
                  <span class="info-popover">Aantal jaar dat de school in gebruik zal zijn. Bepaalt de TCO-berekening: een langere gebruiksduur verlaagt de jaarlijkse kosten maar verhoogt de totale onderhoudslasten.</span>
                </span>
              </div>

            </div>
          </div>
        </div>

        <div class="flex justify-end mt-8 max-w-2xl">
          <button onclick="volgendeStap()" class="btn-primary px-6 py-2">volgende stap</button>
        </div>
      </div>
    </div>
  </div>

  <script src="js/state.js"></script>
  <script src="js/calculations.js"></script>
  <script>
    const project = getCurrentProject();
    if (!project) { window.location.href = 'index.html'; }

    document.getElementById('project-titel').textContent = project.naam;
    document.getElementById('step-indicator').innerHTML  = renderStepIndicator(1, 5, []);
    document.getElementById('nav-panel').innerHTML       = renderNavPanel('pve', project);

    // Load saved value if present
    if (project.gebruiksduur) {
      document.getElementById('gebruiksduur').value = project.gebruiksduur;
    }

    function volgendeStap() {
      const val = parseInt(document.getElementById('gebruiksduur').value) || 40;
      updateCurrentProject({ gebruiksduur: val });
      window.location.href = 'pve-stap-2-voorzieningen.html';
    }

    // Info popovers
    document.addEventListener('click', e => {
      const btn = e.target.closest('.info-btn');
      const allPopovers = document.querySelectorAll('.info-popover.open');
      const allBtns = document.querySelectorAll('.info-btn.open');
      if (btn) {
        const popover = btn.nextElementSibling;
        const isOpen = popover.classList.contains('open');
        allPopovers.forEach(p => p.classList.remove('open'));
        allBtns.forEach(b => b.classList.remove('open'));
        if (!isOpen) { popover.classList.add('open'); btn.classList.add('open'); }
      } else if (!e.target.closest('.info-wrap')) {
        allPopovers.forEach(p => p.classList.remove('open'));
        allBtns.forEach(b => b.classList.remove('open'));
      }
    });
  </script>
  <script src="js/bot.js"></script>
</body>
</html>
